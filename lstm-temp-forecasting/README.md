# 適温予測モデル（LSTM を用いた時系列回帰）

## 概要

このプロジェクトは、室温・体温・アンケート結果などの時系列データを用いて、「適温」を予測する LSTM モデルの実装です。  
特徴量の作成からデータ拡張、正規化、時系列データ生成、ハイパーパラメータチューニングを行い、最適なモデルを探索します。

---

## データセット

- `../datasets/temp_data.csv`
  - 体温、室温、アンケート結果などの時系列データが含まれています。

---

## 主な処理内容

1. **特徴量エンジニアリング**

   - 1 時刻前のラグ特徴量（体温\_lag1、室温\_lag1）
   - 体温と室温の差分特徴量（delta_temp など）
   - 移動平均・移動分散（ウィンドウサイズ 3）

2. **欠損値処理**

   - ラグや移動平均で生じた NaN を削除

3. **データ拡張**

   - 元データに微小なノイズを加えて拡張

4. **正規化**

   - 特徴量とターゲットを MinMaxScaler でスケーリング

5. **時系列データ生成**

   - 指定したタイムステップ数で入力シーケンスを作成

6. **モデル構築と学習**

   - 双方向 LSTM を 2 層重ね、正則化・LayerNormalization・残差接続を適用
   - AdamW オプティマイザを使用
   - 早期停止と学習率減衰のコールバック設定
   - ハイパーパラメータ（エポック数、バッチサイズ、ユニット数、ドロップアウト率、L2 正則化強度）をランダムに組み合わせて 15 回トライ

7. **最良モデルの選択**
   - 検証損失が最小となるモデルとハイパーパラメータを記録
