# 📘 適温予測モデル：スマートリング・赤外線アレイセンサによる体温データを用いて

## 🔍 概要

本プロジェクトでは、**スマートリングや赤外線アレイセンサで取得した体温データ**に加えて、室温、アンケート情報を活用し、**適温（主観的にユーザーが心地よいと感じる温度）**を予測する 3 種類のモデルを構築しました。

- XGBoost 回帰モデル（`xgb.ipynb`）
- LSTM（`lstm.ipynb`）
- LSTM + XGBoost（`lstm_xgb.ipynb`）

---

## 🛠️ 使用センサ・機器

- **スマートリング**：スマホサービス「w302352」
- **赤外線アレイセンサ**：Omron D6T-44L-06
- **室温センサ**：Sensirion SHT31-DIS
- **マイコン**：Raspberry Pi Pico

## 📂 データ

体温、室温、アンケート結果、適温などを含むセンサデータ（それぞれのサンプル数：384）

- `ring_data.csv`：体温をスマートリング(ring)で測定
- `ias_data.csv`：体温を赤外線アレイセンサ(ias)で測定
- ex:)

  | 体温 | 室温 | アンケート | 適温 |
  | ---- | ---- | ---------- | ---- |
  | 36.5 | 22.1 | 0          | 22.1 |

---

## 🛠 特徴量エンジニアリング

### 基本特徴量

- 現在・過去の体温・室温（lag 特徴）
- 差分特徴量（室温 − 体温）
- 移動平均・分散・最大・最小・中央値
- 温度の線形傾向（トレンド）など

---

## 📈 評価指標

| 指標名       | 解釈                                                                                 |
| ------------ | ------------------------------------------------------------------------------------ |
| **MSE**      | 小さいほど誤差が少なく、モデルが実測値に近い予測をしていることを示す。               |
| **RMSE**     | 小さいほど平均的な誤差が少ない。単位が元のデータと同じで直感的に理解しやすい。       |
| **MAE**      | 小さいほど予測値と実測値の絶対的な差が少ない。ノイズに比較的頑健。                   |
| **R² Score** | 1 に近いほどモデルがデータの分散をよく説明している。0 以下なら全く説明できていない。 |
|              |

これらの評価結果は `results/` フォルダに CSV 形式で保存され、各モデルの精度を比較可能にしています。

## 📌 考察と工夫（概要）

本研究では、スマートリングや赤外線アレイセンサから得られた体温データおよび室温・アンケート情報を用いて主観的な「適温」を予測するモデルを構築しました。  
実験の結果、**LSTM 単体モデルが最も高い予測精度を示し**、時系列データの取り扱いが効果的であることが確認されました。

一方で、XGBoost や LSTM+XGBoost のハイブリッドモデルでは、データの限界やモデルの特性により性能がやや劣る傾向が見られました。

本研究での詳細な考察や、モデル性能向上のために工夫した点については、  
`compare_model_performance.ipynb` に詳しく記載していますので、そちらをご参照ください。

---
